package com.login;

import java.lang.reflect.Method;
import java.util.List;
import java.util.Map;

import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import com.hms.login.page.HMSLoginPage;
import com.util.TestBaseClass;
import com.util.TestDataReadingSamples;

Run All
public class TestLogin extends TestBaseClass {

	Map<String, List<Map<String, String>>> testcasesWithSamples;

	@BeforeTest
	public void luanchHMSApp() {
		System.setProperty("webdriver.chrome.driver",
				"C:\\Users\\ADMIN\\Downloads\\chromedriver_win32 (1)\\chromedriver.exe");
		ChromeOptions chromeOptions = new ChromeOptions();
		chromeOptions.addArguments("--remote-allow-origins=*");
		driver = new ChromeDriver(chromeOptions);
		driver.get("https://www.kosmiktechnologies.com/seleniumLiveProject/kosmik-hms/index.php");
		driver.manage().window().maximize();
	}

	@BeforeClass
	public void beforeClass() throws Exception {
		TestDataReadingSamples testDataReadingSamples = new TestDataReadingSamples();
		testcasesWithSamples = testDataReadingSamples.testDataReading("C:\\Users\\ADMIN\\Desktop\\logindata.xlsx",
				"Login");
	}

	@Test(dataProvider = "testData")
	// line 17 & 33 values should be similar
	Run | Debug
	public void testLoginNegative(Map<String, String> sample, String expectedResult) {
		HMSLoginPage page = new HMSLoginPage(driver);
		page.hmsLogin(sample.get("username"), sample.get("pwd"));
		page.logout();
	}

	@Test(dataProvider = "testData")
	// line 17 & 33 values should be similar
	Run | Debug
	public void testLoginPositive(Map<String, String> sample, String expectedResult) {
		HMSLoginPage page = new HMSLoginPage(driver);
		page.hmsLogin(sample.get("username"), sample.get("pwd"));
		page.logout();
	}

	@DataProvider(name = "testData")
	public Object[][] testData(Method method) {
		String testMethodName = method.getName();
		System.out.println("Runtime testMethodName" + testMethodName);

		List<Map<String, String>> samples = testcasesWithSamples.get(testMethodName);
		Object[][] objArr = null;

		if (samples == null) {
			objArr = new Object[0][0];
		} else {
			objArr = new Object[samples.size()][2];
			Integer count = 0;
			for (Map<String, String> sample : samples) {
				objArr[0][0] = sample;
				count++;
				objArr[0][count] = sample.get("Expected Result");

			}
		}

		return objArr;

	}

}
