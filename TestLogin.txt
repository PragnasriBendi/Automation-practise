package com.login;

import java.io.FileInputStream;

import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import com.hms.login.page.HMSLoginPage;
import com.util.TestBaseClass;

Run All
public class TestLogin extends TestBaseClass {
	
	@BeforeTest
	public void luanchHMSApp() {
		System.setProperty("webdriver.chrome.driver",
				"C:\\Users\\ADMIN\\Downloads\\chromedriver_win32 (1)\\chromedriver.exe");
		ChromeOptions chromeOptions = new ChromeOptions();
		chromeOptions.addArguments("--remote-allow-origins=*");
		driver = new ChromeDriver(chromeOptions);
		driver.get("https://www.kosmiktechnologies.com/seleniumLiveProject/kosmik-hms/index.php");
		driver.manage().window().maximize();
	}
	

	@Test(dataProvider = "testData")
	//line 17 & 33 values should be similar 
	Run | Debug
	public void testLoginPositive(String user,String pwd) {
		HMSLoginPage page = new HMSLoginPage(driver);
		page.hmsLogin(user, pwd);
		page.logout();
	}
	
	@Test(dataProvider = "testData")
	//line 17 & 33 values should be similar 
	Run | Debug
	public void testLoginNegative(String user,String pwd) {
		HMSLoginPage page = new HMSLoginPage(driver);
		page.hmsLogin(user, pwd);
		page.logout();
	}
	
	@DataProvider(name = "testData")
	public Object[][] testData() throws Exception {
		FileInputStream fis = new FileInputStream("C:\\Users\\ADMIN\\Desktop\\logindata.xlsx");
		Workbook workbook = null;
		workbook = new XSSFWorkbook(fis);
		Sheet sheet = workbook.getSheet("valid-credentials");
		Row row2 = sheet.getRow(1);
		Row row3 = sheet.getRow(2);
		Object[][] testData = { 
				{ row2.getCell(0).toString(), row2.getCell(1).toString()  }, 
				{ row3.getCell(0).toString(), row3.getCell(1).toString()  }
				};
		workbook.close();
		return testData;

	}
	
}
